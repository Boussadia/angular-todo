/*! <%= pkg.title || pkg.name %> - v<%= pkg.version %> - <%= grunt.template.today("yyyy-mm-dd") %>
<%= pkg.homepage ? "* " + pkg.homepage + "\n" : "" %>* Copyright (c) <%= grunt.template.today("yyyy") %> <%= pkg.author.name %>; Licensed <%= _.pluck(pkg.licenses, "type").join(", ") %> */
"use strict";function validate(a,b){13===b.keyCode&&a.targetScope.$broadcast("todo:validate")}angular.module("TodosAnimations",["ngAnimate"]);var TodoListApp=angular.module("TodoListApp",["ngRoute","TodosAnimations","todoListFilter","TodoControllers"]);TodoListApp.config(["$routeProvider",function(a){a.when("/todos",{templateUrl:"partials/main.html",controller:"MainCtrl",event:{route:"main"}}).when("/todos/new",{templateUrl:"partials/todo.html",controller:"NewTodoCtrl",event:{route:"new"}}).when("/todos/:todoId",{templateUrl:"partials/todo.html",controller:"EditTodoCtrl",event:{route:"edit"}}).otherwise({redirectTo:"/todos"})}]);var TodoControllers=angular.module("TodoControllers",["ui.bootstrap","TodoServices","todoListFilter"]);TodoControllers.controller("MainCtrl",["$scope","storage",function(a,b){b.init(),a.todos=b.todos,a.setDone=function(a){var c=b.get_task(a);c.done=!c.done,b.add(c,a)},a.clear=function(a){b.remove(a)}}]),TodoControllers.controller("EditTodoCtrl",["$scope","$routeParams","$location","storage",function(a,b,c,d){var e=b.todoId;a.state="edit";var f=d.get_task(e);f||(alert("La todo n'existe pas !"),c.path("/")),a.title=f.title,a.description=f.description,a.editTodo=function(a,b){a?(d.add({description:b,title:a,done:d.todos[e].done},e),c.path("/")):alert("Le titre ne doit pas être vide !")},a.$on("todo:keyup",validate),a.$on("todo:validate",function(){a.editTodo(a.title,a.description)})}]),TodoControllers.controller("NewTodoCtrl",["$scope","$location","storage",function(a,b,c){a.title="",a.description="",a.state="new",a.addNewTodo=function(a,d){a?(c.add({title:a,description:d||"",done:!1}),b.path("/")):alert("Le titre ne doit pas être vide !")},a.$on("todo:keyup",validate),a.$on("todo:validate",function(){a.addNewTodo(a.title,a.description)})}]),TodoControllers.controller("NavCtrl",["$scope","$route",function(a,b){a.route={name:""},a.$on("$routeChangeSuccess",function(){a.route.name=b.current.event?b.current.event.route:""})}]),angular.module("todoListFilter",[]).filter("checked",function(){return function(a){return a?"done":""}}),angular.module("TodoServices",["LocalStorageModule"],["$provide",function(a){a.factory("storage",["localStorageService",function(a){return{todos:[],add:function(b,c){if(this.init(),0===c||c)this.todos[c]=b;else{var d=this.todos.push(b);a.add("nb_tasks",d),c=d-1}a.add("task_"+c,JSON.stringify(b))},remove:function(b){if(this.init(),0===b||b){for(var c=(this.todos.splice(b,1),this.get_nb_tasks()),d=b+1;c>d;d++){var e=a.get("task_"+d);a.add("task_"+(d-1),e)}a.remove("task_"+(c-1)),a.add("nb_tasks",c-1)}else a.clearAll(),a.add("nb_tasks",0),this.todos.length=0},init:function(){var b=this.get_nb_tasks();if(b!==this.todos.length)for(var c=0;b>c;c++){var d=JSON.parse(a.get("task_"+c));this.todos.push(d)}a.add("nb_tasks",b)},get_nb_tasks:function(){return parseInt(a.get("nb_tasks")||"0")},get_task:function(a){return this.init(),a<this.todos.length?this.todos[a]:void 0}}}])}]);